/*
 jSmart Javascript template engine
 http://code.google.com/p/jsmart/

 Copyright 2011, Max Miroshnikov <miroshnikov at gmail dot com> 
 jSmart is licensed under the GNU General Public License
 http://www.apache.org/licenses/LICENSE-2.0
*/
(function(){function w(a,b){for(var c=2;c<arguments.length;++c)for(var d in arguments[c])if(arguments[c].hasOwnProperty(d))if(typeof arguments[c][d]=="object"&&arguments[c][d]!=null){b[a+d]=arguments[c][d]instanceof Array?[]:{};w("",b[a+d],arguments[c][d])}else b[a+d]=arguments[c][d];return b}function G(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b}function q(a){if(a.match(/^['"].*['"]$/))a=eval(a);return a.replace(/^\s+|\s+$/g,"")}function u(a,b){for(var c=0,d=0,e=jSmart.prototype.auto_literal,
f=RegExp("^{ *("+a+") *}$","i"),g=0;g<b.length;++g)if(b.substr(g,1)==jSmart.prototype.ldelim){if(!(e&&g+1<b.length&&" \n\r\t".indexOf(b[g+1])>=0)){if(!c){b=b.slice(g);d+=g;g=0}++c}}else if(b.substr(g,1)==jSmart.prototype.rdelim)if(!(e&&g-1>=0&&" \n\r\t".indexOf(b[g-1])>=0)){if(!--c){var h=b.slice(0,g+1).replace(/[\r\n]/g," ").match(f);if(h){h.index=d;return h}}if(c<0)c=0}return null}function D(a,b,c){var d="",e=null,f=null,g=0;do{if(e)g+=e[0].length;e=u(a,c);if(!e)throw Error("Unclosed {"+b+"}");
d+=c.slice(0,e.index);g+=e.index;c=c.slice(e.index+e[0].length);if(f=u(b,d))d=d.slice(f.index+f[0].length)}while(f);e.index=g;return e}function z(a,b,c,d){for(var e=0,f=u(c,d);f;f=u(c,d)){var g=u(a,d);if(!g||g.index>f.index){f.index+=e;return f}else{d=d.slice(g.index+g[0].length);e+=g.index+g[0].length;f=D(b,a,d);d=d.slice(f.index+f[0].length);e+=f.index+f[0].length}}return null}function H(a){return a.replace(/([$]\w+)@(index|iteration|first|last|show|total)/gi,"$1__$2")}function l(a,b){if(typeof a==
"string")with(I)with(b)try{return eval(a)}catch(c){throw Error(c.message+" in \n"+a);}return a}function r(a,b,c){with({__data:c,__v:b})if(a.match(/\[\]$/)){a=a.replace(/\[\]$/,"");eval("__data."+a+".push(__v)")}else eval("__data."+a+"=__v")}function i(a,b){for(var c=u(".+",a);c;c=u(".+",a)){c.index&&m(a.slice(0,c.index),b);a=a.slice(c.index+c[0].length);var d=c[1].match(/^\s*(\w+)(.*)$/);if(d){var e=d[1];d=d.length>2?d[2]:"";if(e in x){if(x[e].type=="block"){a=a.replace(/^\n/,"");c=D("/"+e,e+" +[^}]*",
a);x[e].parse(d,b,a.slice(0,c.index));a=a.slice(c.index+c[0].length)}else{x[e].parse(d,b);if(e=="extends")b=[]}a=a.replace(/^\n/,"")}else if(e in p){c=p[e];if(c.type=="block"){c=D("/"+e,e+" +[^}]*",a);d=n(d);var f=a.slice(0,c.index);b.push({type:"plugin",name:e,params:d,subTree:i(f,[])});a=a.slice(c.index+c[0].length)}else if(c.type=="function"){d=n(d);b.push({type:"plugin",name:e,params:d})}if(e=="append"||e=="assign"||e=="capture"||e=="eval"||e=="include"||e=="while"||e=="nocache")a=a.replace(/^\n/,
"")}else b.push(A(c[1]).tree)}else{b.push(A(c[1]).tree);if(b[b.length-1].name=="__operator"&&b[b.length-1].op=="=")a=a.replace(/^\n/,"")}}a&&m(a,b);return b}function m(a,b){if(m.parseEmbeddedVars)for(var c=/([$][\w@]+)|`([^`]*)`/,d=a.match(c);d;d=a.match(c)){b.push({type:"text",data:a.slice(0,d.index)});b.push(A(d[1]?d[1]:d[2]).tree);a=a.slice(d.index+d[0].length)}b.push({type:"text",data:a});return b}function y(a,b){b.push({type:"var",name:H(a)});return b}function J(a,b,c){b.__parsed.name=m(a,[])[0];
c.push({type:"plugin",name:"__func",params:b});return c}function j(a,b,c,d){d.push({type:"build-in",name:"__operator",op:a,optype:b,precedence:c,params:{}})}function o(a,b){if(o.stop)return false;if(a.match(/^[|](\w+)(?:\s*(:)\s*)?/)){b.value+=RegExp.lastMatch;var c=RegExp.$1;if(c=="default")c="defaultValue";a=a.slice(RegExp.lastMatch.length).replace(/^\s+/,"");o.stop=true;var d=n(RegExp.$2?a:"",/^\s*:\s*/);o.stop=false;b.value+=d.str;d.unshift(b.token);d.__parsed.unshift(b.tree.pop());b.tree.push(J(c,
d,[])[0]);a=a.slice(d.str.length);o(a,b);return true}return false}function M(a,b){if(!a)return false;if(o.stop&&b.tree.length)return false;if(a.match("^"+jSmart.prototype.ldelim)){var c=u(".*",a);if(c){b.value+=c[0];i(c[0],b.tree);o(a.slice(b.value.length),b);return true}}for(c=0;c<B.length;++c)if(a.match(RegExp("^"+B[c].re.source,"i"))){b.token=RegExp.lastMatch;b.value+=RegExp.lastMatch;B[c].parse(b,a.slice(b.token.length));return true}return false}function K(a,b,c){var d=b[a];if(d.name=="__operator"&&
d.precedence==c&&!d.params.__parsed){if(d.optype=="binary"){d.params.__parsed=[b[a-1],b[a+1]];b.splice(a-1,3,d);return true}else if(d.optype=="post-unary"){d.params.__parsed=[b[a-1]];b.splice(a-1,2,d);return true}d.params.__parsed=[b[a+1]];b.splice(a,2,d)}return false}function L(a){var b=0;for(b=0;b<a.length;++b)if(a[b]instanceof Array)a[b]=L(a[b]);for(var c=1;c<14;++c)if(c==2||c==10)for(b=a.length;b>0;--b)b-=K(b-1,a,c);else for(b=0;b<a.length;++b)b-=K(b,a,c);return a[0]}function A(a){for(var b={value:"",
tree:[]};M(a.slice(b.value.length),b););if(!b.tree.length)return false;b.tree=L(b.tree);return b}function n(a,b,c){a=a.replace(/\n/g," ").replace(/^\s+|\s+$/g,"");var d=[];d.__parsed=[];d.str="";if(!a)return d;if(!b){b=/^\s+/;c=/^(\w+)\s*=\s*/}for(;a;){var e=null;if(c){var f=a.match(c);if(f){e=q(f[1]);d.str+=a.slice(0,f[0].length);a=a.slice(f[0].length)}}f=A(a);if(!f)break;if(e){d[e]=f.value;d.__parsed[e]=f.tree}else{d.push(f.value);d.__parsed.push(f.tree);if(isNaN(f.value)){d[f.value]=true;d.__parsed[f.value]=
m("1",[])}}d.str+=a.slice(0,f.value.length);a=a.slice(f.value.length);if(e=a.match(b)){d.str+=a.slice(0,e[0].length);a=a.slice(e[0].length)}else break}return d}function t(a,b){var c=[],d;for(d in a.__parsed)if(a.__parsed.hasOwnProperty(d)){var e=k([a.__parsed[d]],b);if(typeof e=="string"&&e.match(/^[1-9]\d*$/)&&!isNaN(e))e=parseInt(e);c[d]=e}c.__get=function(f,g,h){if(f in c&&typeof c[f]!="undefined")return c[f];if(typeof h!="undefined"&&typeof c[h]!="undefined")return c[h];if(g===null)throw Error("The required attribute '"+
f+"' is missing");return g};return c}function k(a,b){for(var c="",d=0;d<a.length;++d){var e="",f=a[d];if(f.type=="text")e=f.data;else if(f.type=="var")try{e=l(f.name,b)}catch(g){e=""}else if(f.type=="build-in")e=x[f.name].process(f,b);else if(f.type=="plugin"){var h=p[f.name];if(h.type=="block"){h={value:true};for(p[f.name].process(t(f.params,b),"",b,h);h.value;){h.value=false;e+=p[f.name].process(t(f.params,b),k(f.subTree,b),b,h)}}else if(h.type=="function")e=p[f.name].process(t(f.params,b),b)}if(typeof e==
"boolean")e=e?"1":"";if(a.length==1)return e;c+=e}return c}function E(a){for(var b="",c=a.match(/{\*/);c;c=a.match(/{\*/)){b+=a.slice(0,c.index);a=a.slice(c.index+c[0].length);c=a.match(/\*}/);if(!c)throw Error("Unclosed {*");a=a.slice(c.index+c[0].length);if(b.match(/\n+$/)&&a.match(/^\n+/)){b=b.replace(/\n+$/,"\n");a=a.replace(/^\n/,"")}}return b+a}var x={__quoted:{process:function(a,b){return t(a.params,b).join("")}},__operator:{process:function(a,b){var c=t(a.params,b);b.__arg1=c[0];if(a.optype==
"binary"){b.__arg2=c[1];if(a.op=="="){var d=a.params.__parsed[0].name;r(d,c[1],b);return""}else if(a.op.match(/(\+=|-=|\*=|\/=|%=)/)){d=a.params.__parsed[0].name;return l(d+a.op+"__arg2",b)}else if(a.op.match(/div/))return l("__arg1 % __arg2"+(a.op=="div"?"==":"!=")+"0",b);else if(a.op.match(/even/))return l("(__arg1 / __arg2) % 2"+(a.op=="even"?"==":"!=")+"0",b);else if(a.op.match(/xor/))return l("(__arg1 || __arg2) && !(__arg1 && __arg2)",b);return l("__arg1 "+a.op+" __arg2",b)}else if(a.op=="!")return l("!__arg1",
b);else{d=a.params.__parsed[0].type=="var"?a.params.__parsed[0].name:c[0];return a.optype=="pre-unary"?l(a.op+d,b):l(d+a.op,b)}}},section:{type:"block",parse:function(a,b,c){var d=[],e=[];b.push({type:"build-in",name:"section",params:n(a),subTree:d,subTreeElse:e});if(a=z("section [^}]+","/section","sectionelse",c)){i(c.slice(0,a.index),d);i(c.slice(a.index+a[0].length).replace(/^[\r\n]/,""),e)}else i(c,d)},process:function(a,b){var c=t(a.params,b);c.loop=l(a.params.loop,b);var d={};b.$smarty.section[c.name]=
d;var e=c.__get("show",true);d.show=e;if(!e)return k(a.subTreeElse,b);var f="";if(c.loop instanceof Object){if(this.foreach(c.name,c.__get("start",0),c.loop instanceof Array?c.loop.length:G(c.loop),c.__get("step",1),c.__get("max"),b,d,function(g){eval(c.name+" = "+g+";");f+=k(a.subTree,b)}))return f}else if(parseInt(c.loop))if(this.foreach(c.name,c.__get("start",0),parseInt(c.loop),c.__get("step",1),c.__get("max"),b,d,function(){f+=k(a.subTree,b)}))return f;return k(a.subTreeElse,b)},foreach:function(a,
b,c,d,e,f,g,h){b=parseInt(b);c=parseInt(c);d=parseInt(d);e=parseInt(e);if(isNaN(e))e=Number.MAX_VALUE;if(b<0){b=c+b;if(b<0)b=0}else if(b>=c)b=c?c-1:0;a=0;for(f=b;f>=0&&f<c&&a<e;f+=d,++a);g.total=a;g.loop=a;a=0;for(f=b;f>=0&&f<c&&a<e;f+=d,++a){g.first=f==b;g.last=f+d<0||f+d>=c;g.index=f;g.index_prev=f-d;g.index_next=f+d;g.iteration=g.rownum=a+1;h(f)}return a}},"for":{type:"block",parse:function(a,b,c){var d=a.match(/^\s*\$(\w+)\s*=\s*([^\s]+)\s*to\s*([^\s]+)\s*(?:step\s*([^\s]+))?\s*(.*)$/);if(!d)throw Error("Invalid {for} parameters: "+
a);a=[];var e=[];b.push({type:"build-in",name:"for",params:n("varName='"+d[1]+"' from="+d[2]+" to="+d[3]+" step="+(d[4]?d[4]:"1")+" "+d[5]),subTree:a,subTreeElse:e});if(b=z("for\\s[^}]+","/for","forelse",c)){i(c.slice(0,b.index),a);i(c.slice(b.index+b[0].length),e)}else i(c,a)},process:function(a,b){var c=t(a.params,b),d=parseInt(c.__get("from")),e=parseInt(c.__get("to")),f=parseInt(c.__get("step"));if(isNaN(f))f=1;var g=parseInt(c.__get("max"));if(isNaN(g))g=Number.MAX_VALUE;var h=0,s="";d=Math.min(Math.ceil(((f>
0?e-d:d-e)+1)/Math.abs(f)),g);for(e=parseInt(c.from);h<d;e+=f,++h){b["$"+c.varName]=e;s+=k(a.subTree,b)}h||(s=k(a.subTreeElse,b));return s}},"if":{type:"block",parse:function(a,b,c){var d=[],e=[];b.push({type:"build-in",name:"if",params:n(a),subTreeIf:d,subTreeElse:e});if(a=z("if\\s+[^}]+","/if","else[^}]*",c)){i(c.slice(0,a.index),d);c=c.slice(a.index+a[0].length);(d=a[1].match(/^elseif(.*)/))?x["if"].parse(d[1],e,c.replace(/^\n/,"")):i(c.replace(/^\n/,""),e)}else i(c,d)},process:function(a,b){return t(a.params,
b)[0]?k(a.subTreeIf,b):k(a.subTreeElse,b)}},foreach:{type:"block",parse:function(a,b,c){var d=null,e=null,f=null,g=null,h=a.match(/^\s*[$](\w+)\s*as\s*[$](\w+)\s*(=>\s*[$](\w+))?\s*$/i);if(h){d="$"+h[1];e=h[4]?h[4]:h[2];f=h[4]?h[2]:null}else{a=n(a);d=a.from;e=q(a.item);if("key"in a)f=q(a.key);if("name"in a)g=q(a.name)}a=[];h=[];b.push({type:"build-in",name:"foreach",arr:d,keyName:f,varName:"$"+e,loopName:g,subTree:a,subTreeElse:h});if(b=z("foreach\\s[^}]+","/foreach","foreachelse",c)){i(c.slice(0,
b.index),a);i(c.slice(b.index+b[0].length).replace(/^[\r\n]/,""),h)}else i(c,a)},process:function(a,b){var c=null;try{c=l(a.arr,b)}catch(d){}c||(c=q(a.arr));c instanceof Object||(c=[c]);var e=G(c);b[a.varName+"__total"]=e;if(a.loopName){b.$smarty.foreach[a.loopName]={};b.$smarty.foreach[a.loopName].total=e}var f="",g=0,h;for(h in c)if(c.hasOwnProperty(h)){b[a.varName+"__key"]=isNaN(h)?h:parseInt(h);if(a.keyName)b["$"+a.keyName]=b[a.varName+"__key"];b[a.varName]=c[h];b[a.varName+"__index"]=parseInt(g);
b[a.varName+"__iteration"]=parseInt(g+1);b[a.varName+"__first"]=g===0;b[a.varName+"__last"]=g==e-1;if(a.loopName){b.$smarty.foreach[a.loopName].index=parseInt(g);b.$smarty.foreach[a.loopName].iteration=parseInt(g+1);b.$smarty.foreach[a.loopName].first=g===0?1:"";b.$smarty.foreach[a.loopName].last=g==e-1?1:""}f+=k(a.subTree,b);++g}b[a.varName+"__show"]=g>0;if(a.loopName)b.$smarty.foreach[a.loopName].show=g>0?1:"";if(g>0)return f;return k(a.subTreeElse,b)}},"function":{type:"block",parse:function(a,
b,c){a=n(a);b=[];p[q(a.name?a.name:a[0])]={type:"function",subTree:b,defautParams:a,process:function(d,e){var f=t(this.defautParams,e);delete f.name;return k(this.subTree,w("$",w("",{},e),f,d))}};i(c.replace(/\n+$/,""),b)}},php:{type:"block",parse:function(){}},"extends":{type:"function",parse:function(a,b){var c=n(a);c=q(c.file?c.file:c[0]);var d=jSmart.prototype.getTemplate(c);if(typeof d!="string")throw Error("No template for "+c);i(E(d.replace(/\r\n/g,"\n")),b)}},block:{type:"block",parse:function(a,
b,c){var d=n(a);b.push({type:"build-in",name:"block",params:d});if(!("append"in d))d.append=false;if(!("prepend"in d))d.prepend=false;d.hasChild=d.hasParent=false;a=y;y=function(e,f){if(e.match(/^\s*[$]smarty.block.child\s*$/))d.hasChild=true;if(e.match(/^\s*[$]smarty.block.parent\s*$/))d.hasParent=true;f.push({type:"var",name:H(e)});return f};b=[];i(c,b);y=a;c=q(d.name?d.name:d[0]);c in v||(v[c]=[]);v[c].push({tree:b,params:d})},process:function(a,b){b.$smarty.block.parent=b.$smarty.block.child=
"";var c=q(a.params.name?a.params.name:a.params[0]);this.processBlocks(v[c],v[c].length-1,b);return b.$smarty.block.child},processBlocks:function(a,b,c){var d=true,e=false;for(b=b;b>=0;--b){if(a[b].params.hasParent){var f=c.$smarty.block.child;c.$smarty.block.child="";this.processBlocks(a,b-1,c);c.$smarty.block.parent=c.$smarty.block.child;c.$smarty.block.child=f}f=c.$smarty.block.child;var g=k(a[b].tree,c);c.$smarty.block.child=f;if(a[b].params.hasChild)c.$smarty.block.child=g;else if(d)c.$smarty.block.child=
g+c.$smarty.block.child;else if(e)c.$smarty.block.child+=g;d=a[b].params.append;e=a[b].params.prepend}}},strip:{type:"block",parse:function(a,b,c){i(c.replace(/[ \t]*[\r\n]+[ \t]*/g,""),b)}},literal:{type:"block",parse:function(a,b,c){m(c,b)}},ldelim:{type:"function",parse:function(a,b){m(jSmart.prototype.ldelim,b)}},rdelim:{type:"function",parse:function(a,b){m(jSmart.prototype.rdelim,b)}}},p={},I={},C={},v=null,F=null,B=[{re:/[$][\w@]+(?:[.]\w+|\[(?:"[^"\\]*(?:\\.[^"\\]*)*"|'[^'\\]*(?:\\.[^'\\]*)*'|\d+|[$][\w@]+|\w+)?\])*/,
parse:function(a,b){y(a.token,a.tree);o(b,a)}},{re:/(true|false)/,parse:function(a){m(a.token.match(/true/i)?"1":"",a.tree)}},{re:/'[^'\\]*(?:\\.[^'\\]*)*'/,parse:function(a,b){m(eval(a.token),a.tree);o(b,a)}},{re:/"[^"\\]*(?:\\.[^"\\]*)*"/,parse:function(a,b){var c=eval(a.token),d=c.match(B[0].re);if(d&&d[0].length==c.length)y(c,a.tree);else{d=[];m.parseEmbeddedVars=true;i(c,d);m.parseEmbeddedVars=false;d.length==1?a.tree.push(d[0]):a.tree.push({type:"build-in",name:"__quoted",params:{__parsed:d}})}o(b,
a)}},{re:/(\w+)\s*[(]/,parse:function(a,b){var c=RegExp.$1,d=n(b,/^\s*,\s*/);J(c,d,a.tree);a.value+=d.str;o(b.slice(d.str.length),a)}},{re:/\s*\(\s*/,parse:function(a){var b=[];a.tree.push(b);b.parent=a.tree;a.tree=b}},{re:/\s*\)\s*/,parse:function(a){if(a.tree.parent)a.tree=a.tree.parent}},{re:/\s*(\+\+|--)\s*/,parse:function(a){a.tree.length&&a.tree[a.tree.length-1].type=="var"?j(RegExp.$1,"post-unary",1,a.tree):j(RegExp.$1,"pre-unary",1,a.tree)}},{re:/\s*(==|!=|===|!==)\s*/,parse:function(a){j(RegExp.$1,
"binary",6,a.tree)}},{re:/\s+(eq|ne|neq)\s+/,parse:function(a){var b=RegExp.$1.replace(/ne(q)?/,"!=").replace(/eq/,"==");j(b,"binary",6,a.tree)}},{re:/\s*!\s*/,parse:function(a){j("!","pre-unary",2,a.tree)}},{re:/\s+not\s+/,parse:function(a){j("!","pre-unary",2,a.tree)}},{re:/\s*(=|\+=|-=|\*=|\/=|%=)\s*/,parse:function(a){j(RegExp.$1,"binary",10,a.tree)}},{re:/\s*(\*|\/|%)\s*/,parse:function(a){j(RegExp.$1,"binary",3,a.tree)}},{re:/\s+mod\s+/,parse:function(a){j("%","binary",3,a.tree)}},{re:/\s*(\+|-)\s*/,
parse:function(a){!a.tree.length||a.tree[a.tree.length-1].name=="__operator"?j(RegExp.$1,"pre-unary",4,a.tree):j(RegExp.$1,"binary",4,a.tree)}},{re:/\s*(<|<=|>|>=|<>)\s*/,parse:function(a){j(RegExp.$1.replace(/<>/,"!="),"binary",5,a.tree)}},{re:/\s+(lt|lte|le|gt|gte|ge)\s+/,parse:function(a){var b=RegExp.$1.replace(/lt/,"<").replace(/l(t)?e/,"<=").replace(/gt/,">").replace(/g(t)?e/,">=");j(b,"binary",5,a.tree)}},{re:/\s+(is\s+(not\s+)?div\s+by)\s+/,parse:function(a){j(RegExp.$2?"div_not":"div","binary",
7,a.tree)}},{re:/\s+is\s+(not\s+)?(even|odd)(\s+by\s+)?\s*/,parse:function(a){j(RegExp.$1?RegExp.$2=="odd"?"even":"even_not":RegExp.$2=="odd"?"even_not":"even","binary",7,a.tree);RegExp.$3||m("1",a.tree)}},{re:/\s*(&&)\s*/,parse:function(a){j(RegExp.$1,"binary",8,a.tree)}},{re:/\s*(\|\|)\s*/,parse:function(a){j(RegExp.$1,"binary",9,a.tree)}},{re:/\s+and\s+/,parse:function(a){j("&&","binary",11,a.tree)}},{re:/\s+xor\s+/,parse:function(a){j("xor","binary",12,a.tree)}},{re:/\s+or\s+/,parse:function(a){j("||",
"binary",13,a.tree)}},{re:/#(\w+)#/,parse:function(a,b){y("$smarty.config."+RegExp.$1,a.tree);o(b,a)}},{re:/\s*\[\s*/,parse:function(a,b){var c=n(b,/^\s*,\s*/,/^('[^'\\]*(?:\\.[^'\\]*)*'|"[^"\\]*(?:\\.[^"\\]*)*"|\w+)\s*=>\s*/);a.tree.push({type:"plugin",name:"__array",params:c});a.value+=c.str;if(c=b.slice(c.str.length).match(/\s*\]\s*/))a.value+=c[0]}},{re:/[\w.]+/,parse:function(a,b){m(a.token,a.tree);o(b,a)}}];jSmart=function(a){this.tree=[];this.blocks={};this.scripts={};this.data={$smarty:{block:{},
capture:{},cycle:{},foreach:{},section:{},now:Math.floor((new Date).getTime()/1E3),"const":{},config:{},current_dir:"/",template:"",ldelim:jSmart.prototype.ldelim,rdelim:jSmart.prototype.rdelim,version:"2.3"}};v=this.blocks;i(E(a.replace(/\r\n/g,"\n")),this.tree)};jSmart.prototype.fetch=function(a){v=this.blocks;F=this.scripts;this.data=w("$",this.data,a);a=k(this.tree,this.data);jSmart.prototype.debugging&&p.debug.process([],this.data);return a};jSmart.prototype.registerPlugin=function(a,b,c){if(a==
"modifier")I[b]=c;else p[b]={type:a,process:c}};jSmart.prototype.configLoad=function(a,b,c){c=c?c:this.data;a=a.replace(/\r\n/g,"\n").replace(/^\s+|\s+$/g,"");for(var d=/^\s*(?:\[([^\]]+)\]|(?:(\w+)[ \t]*=[ \t]*("""|'[^'\\\n]*(?:\\.[^'\\\n]*)*'|"[^"\\\n]*(?:\\.[^"\\\n]*)*"|[^\n]*)))/m,e="",f=a.match(d);f;f=a.match(d)){a=a.slice(f.index+f[0].length);if(f[1])e=f[1];else if((!e||e==b)&&e.substr(0,1)!=".")if(f[3]=='"""'){var g=a.match(/"""/);if(g){c.$smarty.config[f[2]]=a.slice(0,g.index);a=a.slice(g.index+
g[0].length)}}else c.$smarty.config[f[2]]=q(f[3]);if(f=a.match(/\n+/))a=a.slice(f.index+f[0].length);else break}};jSmart.prototype.clearConfig=function(a){if(a)delete this.data.$smarty.config[a];else this.data.$smarty.config={}};jSmart.prototype.getTemplate=function(a){throw Error("No template for "+a);};jSmart.prototype.getFile=function(a){throw Error("No file for "+a);};jSmart.prototype.getJavascript=function(a){throw Error("No Javascript for "+a);};jSmart.prototype.getConfig=function(a){throw Error("No config for "+
a);};jSmart.prototype.auto_literal=true;jSmart.prototype.ldelim="{";jSmart.prototype.rdelim="}";jSmart.prototype.debugging=false;jSmart.prototype.PHPJS=function(a,b){if(eval("typeof "+a)=="function")return window;else if(typeof PHP_JS=="function")return new PHP_JS;throw Error("Modifier '"+b+"' uses '"+a+"' implementation from php.js project. Find out more at http://phpjs.org");};jSmart.prototype.makeTimeStamp=function(a){if(!a)return Math.floor((new Date).getTime()/1E3);if(isNaN(a)){a=jSmart.prototype.PHPJS("strtotime",
"date_format").strtotime(a);if(a==-1||a===false)return Math.floor((new Date).getTime()/1E3);return a}a=new String(a);if(a.length==14)return Math.floor((new Date(a.substr(0,4),a.substr(4,2)-1,a.substr(6,2),a.substr(8,2),a.substr(10,2))).getTime()/1E3);return parseInt(a)};jSmart.prototype.registerPlugin("function","__func",function(a,b){for(var c=[],d=0;d<a.length;++d){c.push(a.name+"__p"+d);b[a.name+"__p"+d]=a[d]}return l(a.name+"("+c.join(",")+")",b)});jSmart.prototype.registerPlugin("function","__array",
function(a){var b=[],c;for(c in a)if(a.hasOwnProperty(c)&&a[c]&&typeof a[c]!="function")b[c]=a[c];return b});jSmart.prototype.registerPlugin("function","append",function(a,b){var c="$"+a.__get("var",null,0);if(!(c in b)||!(b[c]instanceof Array))b[c]=[];var d=a.__get("index",false),e=a.__get("value",null,1);if(d===false)b[c].push(e);else b[c][d]=e;return""});jSmart.prototype.registerPlugin("function","assign",function(a,b){r("$"+a.__get("var",null,0),a.__get("value",null,1),b);return""});jSmart.prototype.registerPlugin("function",
"call",function(a,b){var c=a.__get("name",null,0);delete a.name;var d=a.__get("assign",false);delete a.assign;c=p[c].process(a,b);if(d){r("$"+d,c,b);return""}return c});jSmart.prototype.registerPlugin("block","capture",function(a,b,c){if(b){b=b.replace(/^\n/,"");c.$smarty.capture[a.__get("name","default",0)]=b;"assign"in a&&r("$"+a.assign,b,c);if(a=a.__get("append",false)){a="$"+a;if(a in c)c[a]instanceof Array&&c[a].push(b);else c[a]=[b]}}return""});jSmart.prototype.registerPlugin("function","counter",
function(a,b){var c="__counter@"+a.__get("name","default");if(c in b){if("start"in a)b[c].value=parseInt(a.start);else{b[c].value=parseInt(b[c].value);b[c].skip=parseInt(b[c].skip);if("down"==b[c].direction)b[c].value-=b[c].skip;else b[c].value+=b[c].skip}b[c].skip=a.__get("skip",b[c].skip);b[c].direction=a.__get("direction",b[c].direction);b[c].assign=a.__get("assign",b[c].assign)}else b[c]={value:parseInt(a.__get("start",1)),skip:parseInt(a.__get("skip",1)),direction:a.__get("direction","up"),assign:a.__get("assign",
false)};if(b[c].assign){b["$"+b[c].assign]=b[c].value;return""}if(a.__get("print",true))return b[c].value;return""});jSmart.prototype.registerPlugin("function","cycle",function(a,b){var c=a.__get("name","default"),d=a.__get("reset",false);if(!(c in b.$smarty.cycle)){b.$smarty.cycle[c]={arr:[""],delimiter:a.__get("delimiter",","),index:0};d=true}if(a.__get("delimiter",false))b.$smarty.cycle[c].delimiter=a.delimiter;var e=a.__get("values",false);if(e){var f=[];if(e instanceof Object)for(nm in e)f.push(e[nm]);
else f=e.split(b.$smarty.cycle[c].delimiter);if(f.length!=b.$smarty.cycle[c].arr.length||f[0]!=b.$smarty.cycle[c].arr[0]){b.$smarty.cycle[c].arr=f;b.$smarty.cycle[c].index=0;d=true}}if(a.__get("advance","true"))b.$smarty.cycle[c].index+=1;if(b.$smarty.cycle[c].index>=b.$smarty.cycle[c].arr.length||d)b.$smarty.cycle[c].index=0;if(a.__get("assign",false)){r("$"+a.assign,b.$smarty.cycle[c].arr[b.$smarty.cycle[c].index],b);return""}if(a.__get("print",true))return b.$smarty.cycle[c].arr[b.$smarty.cycle[c].index];
return""});jSmart.prototype.print_r=function(a,b){if(a instanceof Object){var c=(a instanceof Array?"Array["+a.length+"]":"Object")+"<br>",d;for(d in a)if(a.hasOwnProperty(d))c+=b+"&nbsp;&nbsp;<strong>"+d+"</strong> : "+jSmart.prototype.print_r(a[d],b+"&nbsp;&nbsp;&nbsp;")+"<br>";return c}return a};jSmart.prototype.registerPlugin("function","debug",function(a,b){typeof dbgWnd!="undefined"&&dbgWnd.close();dbgWnd=window.open("","","width=680,height=600,resizable,scrollbars=yes");var c="",d=0,e;for(e in b)c+=
"<tr class="+(++d%2?"odd":"even")+"><td><strong>"+e+"</strong></td><td>"+jSmart.prototype.print_r(b[e],"")+"</td></tr>";dbgWnd.document.write("                <html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en'>                <head> \t\t            <title>jSmart Debug Console</title>                   <style type='text/css'>                      table {width: 100%;}                      td {vertical-align:top;width: 50%;}                      .even td {background-color: #fafafa;}                   </style>                </head>                <body>                   <h1>jSmart Debug Console</h1>                   <h2>assigned template variables</h2>                   <table>"+
c+"</table>                </body>                </html>             ");return""});jSmart.prototype.registerPlugin("function","eval",function(a,b){var c=[];i(a.__get("var","",0),c);c=k(c,b);if("assign"in a){r("$"+a.assign,c,b);return""}return c});jSmart.prototype.registerPlugin("function","fetch",function(a,b){var c=jSmart.prototype.getFile(a.__get("file",null,0));if("assign"in a){r("$"+a.assign,c,b);return""}return c});jSmart.prototype.registerPlugin("function","include",function(a,b){var c=a.__get("file",
null,0);if(!(c in C)){C[c]=[];var d=jSmart.prototype.getTemplate(c);if(typeof d!="string")throw Error("No template for "+c);i(E(d.replace(/\r\n/g,"\n")),C[c])}d=w("$",w("",{},b),a);d.$smarty.template=c;c=k(C[c],d);if("assign"in a){r("$"+a.assign,c,b);return""}return c});jSmart.prototype.registerPlugin("function","include_javascript",function(a,b){var c=a.__get("file",null,0);if(a.__get("once",true)&&c in F)return"";F[c]=true;c=l(jSmart.prototype.getJavascript(c),{$this:b});if("assign"in a){r("$"+
a.assign,c,b);return""}return c});jSmart.prototype.registerPlugin("function","include_php",function(a,b){return p.include_javascript.process(a,b)});jSmart.prototype.registerPlugin("function","insert",function(a,b){var c={},d;for(d in a)if(a.hasOwnProperty(d)&&isNaN(d)&&a[d]&&typeof a[d]=="string"&&d!="name"&&d!="assign"&&d!="script")c[d]=a[d];d="insert_";if("script"in a){eval(jSmart.prototype.getJavascript(a.script));d="smarty_insert_"}c=eval(d+a.__get("name",null,0))(c,b);if("assign"in a){r("$"+
a.assign,c,b);return""}return c});jSmart.prototype.registerPlugin("block","javascript",function(a,b,c){l(b,c);return""});jSmart.prototype.registerPlugin("function","config_load",function(a,b){jSmart.prototype.configLoad(jSmart.prototype.getConfig(a.__get("file",null,0)),a.__get("section","",1),b);return""});jSmart.prototype.registerPlugin("block","nocache",function(a,b){return b});jSmart.prototype.registerPlugin("block","while",function(a,b,c,d){if(b){d.value=Boolean(a[0]);return d.value?b.replace(/^\n/,
""):""}});jSmart.prototype.registerPlugin("modifier","capitalize",function(a,b){var c=RegExp(b?"[\\W\\d]+":"\\W+"),d=null,e="";for(d=a.match(c);d;d=a.match(c)){var f=a.slice(0,d.index);e+=f.match(/\d/)?f:f.charAt(0).toUpperCase()+f.slice(1);e+=a.slice(d.index,d.index+d[0].length);a=a.slice(d.index+d[0].length)}if(a.match(/\d/))return e+a;return e+a.charAt(0).toUpperCase()+a.slice(1)});jSmart.prototype.registerPlugin("modifier","cat",function(a,b){b=b?b:"";return a+b});jSmart.prototype.registerPlugin("modifier",
"count_characters",function(a,b){return b?a.length:a.replace(/\s/g,"").length});jSmart.prototype.registerPlugin("modifier","count_paragraphs",function(a){if(a=a.match(/\n+/g))return a.length+1;return 1});jSmart.prototype.registerPlugin("modifier","count_sentences",function(a){if(a=a.match(/[^\s]\.(?!\w)/g))return a.length;return 0});jSmart.prototype.registerPlugin("modifier","count_words",function(a){if(a=a.match(/\w+/g))return a.length;return 0});jSmart.prototype.registerPlugin("modifier","date_format",
function(a,b,c){return jSmart.prototype.PHPJS("strftime","date_format").strftime(b?b:"%b %e, %Y",jSmart.prototype.makeTimeStamp(a?a:c))});jSmart.prototype.registerPlugin("modifier","defaultValue",function(a,b){return a&&a!="null"&&a!="undefined"?a:b?b:""});jSmart.prototype.registerPlugin("modifier","escape",function(a,b,c){b=b?b:"html";c=c?c:"UTF-8";switch(b){case "html":return jSmart.prototype.PHPJS("htmlspecialchars","escape").htmlspecialchars(a,3,c);case "htmlall":return jSmart.prototype.PHPJS("htmlentities",
"escape").htmlentities(a,3,c);case "url":return jSmart.prototype.PHPJS("rawurlencode","escape").rawurlencode(a);case "urlpathinfo":return jSmart.prototype.PHPJS("rawurlencode","escape").rawurlencode(a).replace(/%2F/g,"/");case "quotes":return a.replace(/([^\\])'/,"$1\\'");case "hex":b="";for(c=0;c<a.length;++c)b+="%"+jSmart.prototype.PHPJS("bin2hex","escape").bin2hex(a.substr(c,1));return b;case "hexentity":b="";for(c=0;c<a.length;++c)b+="&#x"+jSmart.prototype.PHPJS("bin2hex","escape").bin2hex(a.substr(c,
1))+";";return b;case "decentity":b="";for(c=0;c<a.length;++c)b+="&#"+jSmart.prototype.PHPJS("ord","escape").ord(a.substr(c,1))+";";return b;case "mail":return a.replace(/@/g," [AT] ").replace(/[.]/g," [DOT] ");case "nonstd":b="";for(c=0;c<a.length;++c){var d=jSmart.prototype.PHPJS("ord","escape").ord(a.substr(c,1));b+=d>=126?"&#"+d+";":a.substr(c,1)}return b;case "javascript":return a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/<\//g,
"</")}return a});jSmart.prototype.registerPlugin("modifier","indent",function(a,b,c){b=b?b:4;c=c?c:" ";for(var d="";b--;)d+=c;b=a.match(/\n+$/);return d+a.replace(/\n+$/,"").replace(/\n/g,"\n"+d)+(b?b[0]:"")});jSmart.prototype.registerPlugin("modifier","lower",function(a){return a.toLowerCase()});jSmart.prototype.registerPlugin("modifier","nl2br",function(a){return a.replace(/\n/g,"<br />\n")});jSmart.prototype.registerPlugin("modifier","regex_replace",function(a,b,c){b=b.match(/^ *\/(.*)\/(.*) *$/);
return(new String(a)).replace(RegExp(b[1],"g"+(b.length>1?b[2]:"")),c)});jSmart.prototype.registerPlugin("modifier","replace",function(a,b,c){if(!b)return a;a=new String(a);b=new String(b);c=new String(c);var d="",e=-1;for(e=a.indexOf(b,e);e>=0;e=a.indexOf(b,e)){d+=a.slice(0,e)+c;e+=b.length;a=a.slice(e)}return d+a});jSmart.prototype.registerPlugin("modifier","spacify",function(a,b){b||(b=" ");return a.replace(/(\n|.)(?!$)/g,"$1"+b)});jSmart.prototype.registerPlugin("modifier","string_format",function(a,
b){return jSmart.prototype.PHPJS("sprintf","string_format").sprintf(b,a)});jSmart.prototype.registerPlugin("modifier","strip",function(a,b){b=b?b:" ";return(new String(a)).replace(/[\s]+/g,b)});jSmart.prototype.registerPlugin("modifier","strip_tags",function(a,b){b=b==null?true:b;return(new String(a)).replace(/<[^>]*?>/g,b?" ":"")});jSmart.prototype.registerPlugin("modifier","truncate",function(a,b,c,d,e){b=b?b:80;c=c!=null?c:"...";if(a.length<=b)return a;b-=Math.min(b,c.length);if(e)return a.slice(0,
Math.floor(b/2))+c+a.slice(a.length-Math.floor(b/2));d||(a=a.slice(0,b+1).replace(/\s+?(\S+)?$/,""));return a.slice(0,b)+c});jSmart.prototype.registerPlugin("modifier","upper",function(a){return a.toUpperCase()});jSmart.prototype.registerPlugin("modifier","wordwrap",function(a,b,c,d){b=b?b:80;c=c?c:"\n";b-=Math.min(b,c.length);a=a.split("\n");var e=0;for(e=0;e<a.length;++e){for(var f=a[e],g="",h=0;h+b<f.length;){var s=f.slice(h,h+b+1);d||(s=s.replace(/(\s+)\S+$/,"$1"));s=s.slice(0,b);h+=s.length;
for(g+=s.replace(/\s+$/,"").replace(/^\s+/,"")+c;f.charAt(h).match(/\s/);)++h}a[e]=g+f.slice(h)}return a.join("\n")});String.prototype.fetch=function(a){return(new jSmart(this)).fetch(a)}})();
